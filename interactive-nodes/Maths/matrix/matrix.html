<script type="text/javascript">
  RED.nodes.registerType("matrix", {
    category: "Interactive Maths",
    color: "#B9E6D7",
    defaults: {
      name: { value: "matrix" },
      matrix: { value: "" },
    },
    inputs: 1,
    outputs: 1,
    icon: "font-awesome/fa-calculator",
    label: function () {
      return this.name || "matrix";
    },
    oneditprepare: function () {
      // Populate the existing matrix value
      $("#node-input-matrix").val(this.matrix);
    },
    oneditsave: function () {
      // Save the matrix value
      this.matrix = $("#node-input-matrix").val();
    },
  });
</script>

<script type="text/html" data-template-name="matrix">
  <div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i>Name</label>
    <input type="text" id="node-input-name" placeholder="Name" />
  </div>
  <div class="form-row">
    <label for="node-input-matrix"
      ><i class="fa fa-cogs"></i> Adjacency Matrix (JSON format)</label
    >
    <input type="text" id="node-input-matrix" placeholder="[[0, 1], [1, 0]]" />
  </div>
</script>

<script type="text/html" data-help-name="matrix">
  <p>
    The <strong>matrix</strong> node is designed to create a NumPy matrix based
    on an adjacency matrix provided in JSON format. This node is particularly
    useful for mathematical operations and graph-based computations in quantum
    algorithms, where adjacency matrices are often used to represent graph
    structures.
  </p>

  <h3>Inputs</h3>
  <ul>
    <li>
      <strong>Name (name)</strong>: An optional name for the node instance,
      useful for identifying it in your Node-RED flow.
    </li>
    <li>
      <strong>Adjacency Matrix (matrix)</strong>: The adjacency matrix in JSON
      format. This matrix should be a string representation of a 2D array (e.g.,
      "[[0, 1], [1, 0]]"). It represents the connections (edges) between nodes
      (vertices) in a graph, where a non-zero entry at position (i, j) indicates
      an edge between node i and node j.
    </li>
  </ul>

  <h3>Outputs</h3>
  <ul>
    <li>
      <strong>msg.payload</strong>: The constructed NumPy matrix based on the
      provided adjacency matrix. This output can be used for further
      mathematical operations or as an input to nodes that require matrix data,
      such as graph algorithms or quantum computing nodes.
    </li>
  </ul>

  <h3>How to Use</h3>
  <ol>
    <li>
      Drag the <strong>matrix</strong> node from the "Maths" category into your
      Node-RED workspace.
    </li>
    <li>Double-click the node to open its configuration panel.</li>
    <li>
      Set the <strong>Name</strong> field (optional) to label your node
      instance.
    </li>
    <li>
      Enter the <strong>Adjacency Matrix</strong> in JSON format. Ensure the
      matrix is correctly formatted as a string representing a 2D array, such as
      "[[0, 1], [1, 0]]".
    </li>
    <li>
      Connect the input of this node to nodes that trigger the creation of the
      matrix or require it for computations, and connect the output to nodes
      that utilize the matrix for further operations.
    </li>
    <li>
      Deploy your flow to save the configuration and create the matrix when the
      flow is triggered.
    </li>
  </ol>

  <h3>Example Use Case</h3>
  <p>
    This node can be used in workflows that require graph representation or
    manipulation, such as graph-based optimization problems in quantum computing
    (e.g., Max-Cut problem using QAOA) or classical graph algorithms. The
    adjacency matrix generated by this node can represent the structure of the
    graph to be processed or optimized.
  </p>

  <h3>Additional Notes</h3>
  <p>
    Ensure that the <strong>Adjacency Matrix</strong> is formatted correctly as
    a JSON string to avoid parsing errors. The matrix should be compatible with
    the mathematical operations or algorithms that will use it. Misformatted
    input may lead to errors or unexpected behavior during execution.
  </p>
</script>